@page "/trades"
@attribute [Authorize]
@inject IAuthService AuthService

<CascadingAuthenticationState>
<AuthorizeView>
<div class="container py-4">
 <div class="d-flex justify-content-between align-items-center mb-4">
  <h4 class="mb-0">Trade Center</h4>
  <a href="/trades/create" class="btn btn-success"><i class="bi bi-plus-lg me-1"></i>Iniciar Troca</a>
 </div>

 @if (!string.IsNullOrEmpty(Message))
 {
  <p class="text-muted">@Message</p>
 }
 else
 {
  <h5 class="mb-3">Minhas Propostas</h5>
  <ul class="nav nav-tabs mb-3" role="tablist">
   <li class="nav-item">
    <button class="nav-link active" type="button" data-bs-toggle="tab" data-bs-target="#recebidas">Recebidas (@Received.Count)</button>
   </li>
   <li class="nav-item">
    <button class="nav-link" type="button" data-bs-toggle="tab" data-bs-target="#enviadas">Enviadas (@Sent.Count)</button>
   </li>
  </ul>

  <div class="tab-content">
   <div class="tab-pane fade show active" id="recebidas">
    @if (Received.Count == 0)
    {
     <p class="text-muted">Nenhuma proposta recebida.</p>
    }
    else
    {
     <div class="list-group">
      @foreach (var t in Received)
      {
       <a href="@($"/tradeoffer/{t.Id}")" class="list-group-item list-group-item-action d-flex justify-content-between align-items-center py-3">
        <div class="d-flex align-items-center gap-3">
         <img src="@($"Images/Logos/{t.TeamOneName}.svg")" alt="" style="width:28px;height:28px" />
         <span class="fw-semibold">@t.TeamOneName</span>
         <i class="bi bi-arrow-right text-muted"></i>
         <img src="@($"Images/Logos/{t.TeamTwoName}.svg")" alt="" style="width:28px;height:28px" />
         <span class="fw-semibold">@t.TeamTwoName</span>
        </div>
        <div class="d-flex align-items-center gap-2">
         <span class="badge @StatusBadge(t.Response)">@StatusText(t.Response)</span>
         <small class="text-muted">@t.DateCreated.ToString("dd/MM/yyyy HH:mm")</small>
        </div>
       </a>
      }
     </div>
    }
   </div>
   <div class="tab-pane fade" id="enviadas">
    @if (Sent.Count == 0)
    {
     <p class="text-muted">Nenhuma proposta enviada.</p>
    }
    else
    {
     <div class="list-group">
      @foreach (var t in Sent)
      {
       <a href="@($"/tradeoffer/{t.Id}")" class="list-group-item list-group-item-action d-flex justify-content-between align-items-center py-3">
        <div class="d-flex align-items-center gap-3">
         <img src="@($"Images/Logos/{t.TeamOneName}.svg")" alt="" style="width:28px;height:28px" />
         <span class="fw-semibold">@t.TeamOneName</span>
         <i class="bi bi-arrow-right text-muted"></i>
         <img src="@($"Images/Logos/{t.TeamTwoName}.svg")" alt="" style="width:28px;height:28px" />
         <span class="fw-semibold">@t.TeamTwoName</span>
        </div>
        <div class="d-flex align-items-center gap-2">
         <span class="badge @StatusBadge(t.Response)">@StatusText(t.Response)</span>
         <small class="text-muted">@t.DateCreated.ToString("dd/MM/yyyy HH:mm")</small>
        </div>
       </a>
      }
     </div>
    }
   </div>
  </div>
 }
</div>
</AuthorizeView>
</CascadingAuthenticationState>
